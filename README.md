# Mobile Apps Api Models

These models are used to communicate between MAPI and the native apps.

## Non-production releases

### Scala

A snapshot version can be released via the github UI.

The steps you should take are:
- Push the branch with the changes you want to release to Github.
- [Click here](https://github.com/guardian/mobile-apps-api-models/releases/new?prerelease=true) to create prerelease using Github releases. You should see a view like this:

<img src="./docs/images/scala-pre-release.png">

You must then:
- Set the Target to your branch.
- Create a tag for the snapshot release (the tag will be created as part of the pre-release if it doesn't already exist).
- The tag should ideally have format "vX.X.X-SNAPSHOT" (the workflow will account for a missing `v` or `-SNAPSHOT`).
- Double-check that the "Set as pre-release" box is ticket.
- To automatically release the snapshot to sonatype, click the "Publish release" button.
- You should be able to find the snapshot release [here](https://oss.sonatype.org/content/repositories/snapshots/com/gu/)

### Swift

Non-production versions of the swift models can be generated by triggering the workflow manually. 
Triggering the workflow requires the user to provide a branch name as an input.
When running the workflow the specified branch will be checked out and the thrift schema will be read from that branch.
The result of running the workflow will be a commit to the specified branch with the generated swift models.

The `Generate native models` workflow can be triggered from the command line or via the Github UI. If triggering via the command line we can use Github's [CLI](https://cli.github.com/):

`gh workflow run 'Generate native models' -f branch_name=<branch with schema changes to convert into models>`

If triggering via the UI, this can be done from the `Actions` tab. The workflow name is "Generate native models":

<img src="./docs/images/native-models-pre-release.png">

